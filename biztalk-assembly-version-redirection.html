<!doctype html>
<html lang="en-US">
  <head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="utf-8" />
  <title>
    Gobbledygooks  &middot; BizTalk assembly version redirection 
  </title>

  <!-- Sitemap -->
  <link
    href="/sitemap.xml"
    rel="sitemap"
    title="Sitemap"
    type="application/xml"
  />

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css">

  <!-- Fathom - beautiful, simple website analytics -->
  <script
    src="https://cdn.usefathom.com/script.js"
    data-site="JOYKGAUK"
    defer
  ></script>
  <!-- / Fathom -->

  <!-- RSS -->
  <link
    rel="alternate"
    type="application/atom+xml"
    title="riha feed"
    href="http://richardhallgren.com/feed"
  />
</head>

  <body class="bg-bg-yellow max-w-[650px]  font-mono  post-page px-4 py-4 " style="margin: 0 auto;" >
    <div class=" ">
      <div class="">
        <div class="flex justify-center">
          <a href="/">
            <img
              src="/assets/riha-profile-image.jpeg"
              class="rounded-full w-32 border-profile-border shadow profile-image"
            >
          </a>
        </div>
      </div>
      <div class="my-12"></div>

      <h1>BizTalk assembly version redirection</h1>
      <div class="my-1"></div>
      <div class="text-center text-text-subtle text-sm">Jan 26, 2007</div>
      
        <p>The version redirection in BizTalk do NOT work as one is used to coming from a ordinary .NET developer background (so I was wrong in <a href="http://richardhallgren.com/blog/?p=50">this post</a> …). Say that we made a reference to a code library in one of our orchestrations. This code library is in version 1.0.0.0 when we build and deploy the orchestration to BizTalk and to the GAC. The setup in VS 2005 looks something like this.</p>

<p><a href="http://richardhallgren.com/blog/wp-content/uploads/2007/02/WindowsLiveWriter/BizTalkassemblyversionredirection_CA12/VersionReference3.jpg"><img src="http://richardhallgren.com/blog/wp-content/uploads/2007/02/WindowsLiveWriter/BizTalkassemblyversionredirection_CA12/VersionReference_thumb3.jpg" alt="" /></a></p>

<p>Then we make some minor changes in the code library, we fix them and set the version to 1.0.1.0. Build and deploy it. This means that we now have one 1.0.0.0 and one 1.0.1.0 version side-by-side in the GAC (as shown in the figure below).</p>

<p><a href="http://richardhallgren.com/blog/wp-content/uploads/2007/02/WindowsLiveWriter/BizTalkassemblyversionredirection_CA12/GAC8.jpg"><img src="http://richardhallgren.com/blog/wp-content/uploads/2007/02/WindowsLiveWriter/BizTalkassemblyversionredirection_CA12/GAC_thumb8.jpg" alt="" /></a></p>

<p>Coming from .NET the CLR should now load the 1.0.1.0 version as it identifies assemblies based on the assembly name, major or minor version (NOT the build and revision version), public key token and culture (<a href="http://www.informit.com/articles/article.asp?p=99977&amp;seqNum=6&amp;rl=1">more about this here</a>).</p>

<p>However, this does NOT work in BizTalk. BizTalk loads assemblies by fullname it has stored in the management database and the build and revision number are part of the fullname … This means we have to build and redelopy EVERY part where we like to use new version of the code library.</p>

<p>There is one way around this for emergency use. Say that one has a code library that is used in loads of BizTalk artifacts (A place where we store all base functionality for the solution). Rebuilding all those parts and redeploying it, just to be able to update the version number, is not going to happened! It’s to much work and to risky. **So it’s possible to make a change in the <em>BTSBTSvc.exe.config</em> file instead. **In my case the change would be something like the below (<a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpgenref/html/gngrfbindingredirect.asp">read more about here</a>).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;div&gt;&lt;span style="color: #000000; "&gt;&lt;&lt;/span&gt;&lt;span style="color: #000000; "&gt;dependentAssembly&lt;/span&gt;&lt;span style="color: #000000; "&gt;&gt;&lt;/span&gt;&lt;span style="color: #000000; "&gt;
  &lt;/span&gt;&lt;span style="color: #000000; "&gt;&lt;&lt;/span&gt;&lt;span style="color: #000000; "&gt;assemblyIdentity name&lt;/span&gt;&lt;span style="color: #000000; "&gt;=&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt;StaticCodeLibrary&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt; publicKeyToken&lt;/span&gt;&lt;span style="color: #000000; "&gt;=&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt;32ab4ba45e0a69a1&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt; culture&lt;/span&gt;&lt;span style="color: #000000; "&gt;=&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt;neutral&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt; &lt;/span&gt;&lt;span style="color: #000000; "&gt;/&gt;&lt;/span&gt;&lt;span style="color: #000000; "&gt;
  &lt;/span&gt;&lt;span style="color: #000000; "&gt;&lt;&lt;/span&gt;&lt;span style="color: #000000; "&gt;bindingRedirect oldVersion&lt;/span&gt;&lt;span style="color: #000000; "&gt;=&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt;1.0.0.0&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt; newVersion&lt;/span&gt;&lt;span style="color: #000000; "&gt;=&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt;1.0.1.0&lt;/span&gt;&lt;span style="color: #000000; "&gt;"&lt;/span&gt;&lt;span style="color: #000000; "&gt;/&gt;&lt;/span&gt;&lt;span style="color: #000000; "&gt;
&lt;/span&gt;&lt;span style="color: #000000; "&gt;&lt;/&lt;/span&gt;&lt;span style="color: #000000; "&gt;dependentAssembly&lt;/span&gt;&lt;span style="color: #000000; "&gt;&gt;&lt;/span&gt;&lt;/div&gt;
</code></pre></div></div>

      
      <div class="mt-6" />
<div class="flex items-baseline justify-center gap-4">
  <a href="https://www.linkedin.com/in/richardhallgren/">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="lucide lucide-linkedin"
    >
      <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" />
      <rect width="4" height="12" x="2" y="9" />
      <circle cx="4" cy="4" r="2" />
    </svg>
  </a>
  <a href="mailto:richard@revision.app">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
      class="lucide lucide-mail"
    >
      <rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
    </svg>
  </a>
</div>

    </div>
  </body>
</html>
